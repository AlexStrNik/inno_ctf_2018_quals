# Реально ценный экспириенс


**Category:** web, rss
**Points:** 400
**Description:**

> Добрый день! Наши разработчики перешли от старых сервисов по работе с RSS на .... более новые сервисы для работы с RSS! Вам предстоит зарядить весь ваш арсенал веб-хакера, чтобы найти мааааааааааленькую лазейку. Ах да, высылаю адрес - http://tcp.innoctf.hackforces.com:8000/
> P.S. Учтите, что сайт - один для всех игроков, поэтому, постарайтесь не наследить - это даст хорошую подсказку другим участникам!
> UPDATE: мы добавили хинт непосредственно в сервис, можете проверять

## WriteUp 

Заходим на сайт, видим выпадающее меню с 4мя RSS сервисами, выбор каждого из них вызывает подгрузку соответствующей ленты.

Можно погуглить кусочек JS'a или просто адрес `getrss.php` и найти практически такой же скрипт. Каких-то уязвимостей в этом скрипте нет, 
про него можно забыть, по большому счету. Разве что если передать какой-то параметр, о котором скрипт не знает, можно увидеть ошибку и узнать путь до файлов сервиса.

Дальше стоит проверить `robots.txt` и найти запрет на индексацию директории `/magpierss`. Гуглим странное названием, находим исходники на гитхабе.
Если их внимательно посмотреть, можно найти папку `scripts`, в которой лежит несколько скриптом, позволяющих передать любой url для парса XML.

Проверка работы XXE заканчивается провалом, сущность SYSTEM просто не выполняется и падает с ошибкой.
Если погуглить еще (либо дальше просматривать исходники) можно найти ошибку в формировании списка аргументов для curl'a, с помощью которого загружаются xml'ки по ссылкам.
Суть ошибки - в curl можно передать произвольные параметры. Смотрим список параметров, находим -o/--output. Дальше заливаем шелл на сервер и находим в корне `flag.txt`
правда, нормально аплоад начинает работать при наличии переадресации с передаваемой страницы на ту, которую надо загрузить на сервер, к примеру, переадресация на https при передаче http.
